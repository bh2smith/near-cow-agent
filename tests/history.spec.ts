import { getOrderHistory } from "@/src/app/api/tools/history/logic";

const accountWithHistory = "0xB00b4C1e371DEe4F6F32072641430656D3F7c064";

describe("Order Cancellation Route", () => {
  it("Should handle Order Cancellation paths", async () => {
    const history = await getOrderHistory({
      chainId: 1,
      evmAddress: accountWithHistory,
    });
    expect(history).toStrictEqual([
      {
        creationDate: "2025-08-21T08:38:43.237176Z",
        owner: "0xb00b4c1e371dee4f6f32072641430656d3f7c064",
        uid: "0x5108382e069f56915134f648557cb815a013b727060a4a3dbedbd7fba959e25bb00b4c1e371dee4f6f32072641430656d3f7c06468a6e209",
        availableBalance: null,
        executedBuyAmount: "22345427469525286",
        executedSellAmount: "95916326",
        executedSellAmountBeforeFees: "95916326",
        executedFeeAmount: "0",
        executedFee: "663485",
        executedFeeToken: "0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",
        invalidated: false,
        status: "fulfilled",
        class: "limit",
        settlementContract: "0x9008d19f58aabd9ed0d60971565aa8510560ab41",
        isLiquidityOrder: false,
        fullAppData:
          '{"appCode":"CoW Swap","environment":"production","metadata":{"hooks":{"pre":[{"callData":"0xd505accf000000000000000000000000b00b4c1e371dee4f6f32072641430656d3f7c064000000000000000000000000c92e8bdf79f0507f65a392b0ab4667716bfe0110ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000720e8268000000000000000000000000000000000000000000000000000000000000001c7b59f22c6fcf22ff9468470b025ce32d1acea0965d66403af74c96c3627bb97c2a2da3d4d0d76ba3a276db762d0c2fac13eb9360c7ce87709fda4a298b3cda52","dappId":"cow-swap://libs/hook-dapp-lib/permit","gasLimit":"92330","target":"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"}]},"orderClass":{"orderClass":"market"},"quote":{"slippageBips":68,"smartSlippage":true},"utm":{"utmContent":"menubar-nav-button-trade-on-cow-swap","utmMedium":"web","utmSource":"cow.fi"}},"version":"1.6.0"}',
        sellToken: "0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",
        buyToken: "0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",
        receiver: "0xb00b4c1e371dee4f6f32072641430656d3f7c064",
        sellAmount: "95916326",
        buyAmount: "22103489461350083",
        validTo: 1755767305,
        appData:
          "0x9dbd7898909d0b133051e577884118061efdf7f3c5aeb41c0fd493c3c5983a7d",
        feeAmount: "0",
        kind: "sell",
        partiallyFillable: false,
        sellTokenBalance: "erc20",
        buyTokenBalance: "erc20",
        signingScheme: "eip712",
        signature:
          "0x595a58ce18b1529a2162b1e835089fa47f6f3f642c130f49895cd76291cdf19c268253b11780eccbc6a6b6c69595f6e33e39a18ebd34e857e534d8189fb7bf931b",
        interactions: {
          pre: [
            {
              target: "0x60bf78233f48ec42ee3f101b9a05ec7878728006",
              value: "0",
              callData:
                "0x760f2a0b000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000168aa00000000000000000000000000000000000000000000000000000000000000e4d505accf000000000000000000000000b00b4c1e371dee4f6f32072641430656d3f7c064000000000000000000000000c92e8bdf79f0507f65a392b0ab4667716bfe0110ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000720e8268000000000000000000000000000000000000000000000000000000000000001c7b59f22c6fcf22ff9468470b025ce32d1acea0965d66403af74c96c3627bb97c2a2da3d4d0d76ba3a276db762d0c2fac13eb9360c7ce87709fda4a298b3cda5200000000000000000000000000000000000000000000000000000000",
            },
          ],
          post: [],
        },
        totalFee: "663485",
      },
      {
        creationDate: "2025-08-21T08:32:18.927442Z",
        owner: "0xb00b4c1e371dee4f6f32072641430656d3f7c064",
        uid: "0xcb6aaca4eb01f53794381e158c3cb3b44b999e36ec10925b66d350bc9c3fed10b00b4c1e371dee4f6f32072641430656d3f7c06468a6e08b",
        availableBalance: null,
        executedBuyAmount: "0",
        executedSellAmount: "0",
        executedSellAmountBeforeFees: "0",
        executedFeeAmount: "0",
        executedFee: "0",
        executedFeeToken: "0xe485e2f1bab389c08721b291f6b59780fec83fd7",
        invalidated: true,
        status: "cancelled",
        class: "limit",
        settlementContract: "0x9008d19f58aabd9ed0d60971565aa8510560ab41",
        isLiquidityOrder: false,
        fullAppData:
          '{"appCode":"CoW Swap","environment":"production","metadata":{"orderClass":{"orderClass":"market"},"quote":{"slippageBips":1,"smartSlippage":false},"utm":{"utmContent":"menubar-nav-button-trade-on-cow-swap","utmMedium":"web","utmSource":"cow.fi"}},"version":"1.6.0"}',
        sellToken: "0xe485e2f1bab389c08721b291f6b59780fec83fd7",
        buyToken: "0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",
        receiver: "0xb00b4c1e371dee4f6f32072641430656d3f7c064",
        sellAmount: "7953398473699851263956",
        buyAmount: "33656781",
        validTo: 1755766923,
        appData:
          "0xe3ccee7d56ecd78544af6d1d773580a5dbb4bc480d180649d7ea1b82f6c3de08",
        feeAmount: "0",
        kind: "sell",
        partiallyFillable: false,
        sellTokenBalance: "erc20",
        buyTokenBalance: "erc20",
        signingScheme: "eip712",
        signature:
          "0x3b5b69790dbf295cc872ab44e76ebb421cd27affb8b759c63b999daa387a65972a647d43d86c6dd51d82d759dd81ee6b9b69cd4752a3ad102197725e38c8f8c61b",
        interactions: {
          pre: [],
          post: [],
        },
        totalFee: "0",
      },
      {
        creationDate: "2025-08-20T13:48:19.140061Z",
        owner: "0xb00b4c1e371dee4f6f32072641430656d3f7c064",
        uid: "0xe03a7e38a045613fa75816ca9d8fd4538d3b5fc5987675d5aa1c14cc07a2f117b00b4c1e371dee4f6f32072641430656d3f7c06468a5d8fe",
        availableBalance: null,
        executedBuyAmount: "0",
        executedSellAmount: "0",
        executedSellAmountBeforeFees: "0",
        executedFeeAmount: "0",
        executedFee: "0",
        executedFeeToken: "0xe485e2f1bab389c08721b291f6b59780fec83fd7",
        invalidated: false,
        status: "expired",
        class: "limit",
        settlementContract: "0x9008d19f58aabd9ed0d60971565aa8510560ab41",
        isLiquidityOrder: false,
        fullAppData:
          '{"appCode":"bitte.ai/CowAgent","metadata":{"partnerFee":{"bps":25,"recipient":"0x54F08c27e75BeA0cdDdb8aA9D69FD61551B19BbA"},"referrer":{"address":"0x8d99F8b2710e6A3B94d9bf465A98E5273069aCBd"}},"version":"1.3.0"}',
        sellToken: "0xe485e2f1bab389c08721b291f6b59780fec83fd7",
        buyToken: "0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",
        receiver: "0xb00b4c1e371dee4f6f32072641430656d3f7c064",
        sellAmount: "4000000000000000000000",
        buyAmount: "16419990",
        validTo: 1755699454,
        appData:
          "0x5a8bb9f6dd0c7f1b4730d9c5a811c2dfe559e67ce9b5ed6965b05e59b8c86b80",
        feeAmount: "0",
        kind: "sell",
        partiallyFillable: false,
        sellTokenBalance: "erc20",
        buyTokenBalance: "erc20",
        signingScheme: "eip712",
        signature:
          "0xe9cbe970208f500a7b606df56b2138e2bb80886a6a0fe4314fe561d3c9b26555589005d426c36ef3ce93a9649e03a34adb6561122a125e56821bcd36f8fe1e4f1c",
        interactions: {
          pre: [],
          post: [],
        },
        totalFee: "0",
      },
      {
        creationDate: "2025-08-11T10:04:42.922723Z",
        owner: "0xb00b4c1e371dee4f6f32072641430656d3f7c064",
        uid: "0xe46e8c19e371fbcc3797898796292cba68eb8cc27ca32d35305e0087d8d9c46ab00b4c1e371dee4f6f32072641430656d3f7c0646899c71e",
        availableBalance: null,
        executedBuyAmount: "0",
        executedSellAmount: "0",
        executedSellAmountBeforeFees: "0",
        executedFeeAmount: "0",
        executedFee: "0",
        executedFeeToken: "0xe485e2f1bab389c08721b291f6b59780fec83fd7",
        invalidated: true,
        status: "cancelled",
        class: "limit",
        settlementContract: "0x9008d19f58aabd9ed0d60971565aa8510560ab41",
        isLiquidityOrder: false,
        fullAppData:
          '{"appCode":"CoW Swap","environment":"production","metadata":{"orderClass":{"orderClass":"market"},"quote":{"slippageBips":1,"smartSlippage":false},"utm":{"utmContent":"menubar-nav-button-trade-on-cow-swap","utmMedium":"web","utmSource":"cow.fi"}},"version":"1.5.0"}',
        sellToken: "0xe485e2f1bab389c08721b291f6b59780fec83fd7",
        buyToken: "0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",
        receiver: "0xb00b4c1e371dee4f6f32072641430656d3f7c064",
        sellAmount: "2000000000000000000000",
        buyAmount: "8157122",
        validTo: 1754908446,
        appData:
          "0x753b3430bef8e6f4d8596d929ec63427802e5bbf99f8a1bbf872ffac876125fc",
        feeAmount: "0",
        kind: "sell",
        partiallyFillable: false,
        sellTokenBalance: "erc20",
        buyTokenBalance: "erc20",
        signingScheme: "eip712",
        signature:
          "0xe1d29bea05abc77a7b72923de8bca8ff2da6d97d5b907855fe39d1a340a992ec36f45a0f77c189122941f2621e0d744a727ea539279213b5dbd72c885b040c791b",
        interactions: {
          pre: [],
          post: [],
        },
        totalFee: "0",
      },
      {
        creationDate: "2025-08-11T09:35:57.586266Z",
        owner: "0xb00b4c1e371dee4f6f32072641430656d3f7c064",
        uid: "0xe78df3254b7b8162f4b025a41f8fa67573575857b0e8c59688f9888342f074f6b00b4c1e371dee4f6f32072641430656d3f7c0646899c054",
        availableBalance: null,
        executedBuyAmount: "0",
        executedSellAmount: "0",
        executedSellAmountBeforeFees: "0",
        executedFeeAmount: "0",
        executedFee: "0",
        executedFeeToken: "0xe485e2f1bab389c08721b291f6b59780fec83fd7",
        invalidated: false,
        status: "expired",
        class: "limit",
        settlementContract: "0x9008d19f58aabd9ed0d60971565aa8510560ab41",
        isLiquidityOrder: false,
        fullAppData:
          '{"appCode":"bitte.ai/CowAgent","metadata":{"partnerFee":{"bps":25,"recipient":"0x54F08c27e75BeA0cdDdb8aA9D69FD61551B19BbA"},"referrer":{"address":"0x8d99F8b2710e6A3B94d9bf465A98E5273069aCBd"}},"version":"1.3.0"}',
        sellToken: "0xe485e2f1bab389c08721b291f6b59780fec83fd7",
        buyToken: "0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",
        receiver: "0xb00b4c1e371dee4f6f32072641430656d3f7c064",
        sellAmount: "5000000000000000000000",
        buyAmount: "21052047",
        validTo: 1754906708,
        appData:
          "0x5a8bb9f6dd0c7f1b4730d9c5a811c2dfe559e67ce9b5ed6965b05e59b8c86b80",
        feeAmount: "0",
        kind: "sell",
        partiallyFillable: false,
        sellTokenBalance: "erc20",
        buyTokenBalance: "erc20",
        signingScheme: "eip712",
        signature:
          "0xc9664b74f39ac444418023f04392f6d3354b8e7cbf4189e51e98f0ea91d5efc64a535bb24926f931fc405dd26abbab90dfefa5267f2207048868f151b7fba31b1b",
        interactions: {
          pre: [],
          post: [],
        },
        totalFee: "0",
      },
      {
        creationDate: "2025-08-08T15:48:19.966188Z",
        owner: "0xb00b4c1e371dee4f6f32072641430656d3f7c064",
        uid: "0xeaa2608341c2263962070fbebd56bee368d399960265d4e34e217108c56b2190b00b4c1e371dee4f6f32072641430656d3f7c06468962347",
        availableBalance: null,
        executedBuyAmount: "0",
        executedSellAmount: "0",
        executedSellAmountBeforeFees: "0",
        executedFeeAmount: "0",
        executedFee: "0",
        executedFeeToken: "0xe485e2f1bab389c08721b291f6b59780fec83fd7",
        invalidated: false,
        status: "expired",
        class: "limit",
        settlementContract: "0x9008d19f58aabd9ed0d60971565aa8510560ab41",
        isLiquidityOrder: false,
        fullAppData:
          '{"appCode":"bitte.ai/CowAgent","metadata":{"partnerFee":{"bps":25,"recipient":"0x54F08c27e75BeA0cdDdb8aA9D69FD61551B19BbA"},"referrer":{"address":"0x8d99F8b2710e6A3B94d9bf465A98E5273069aCBd"}},"version":"1.3.0"}',
        sellToken: "0xe485e2f1bab389c08721b291f6b59780fec83fd7",
        buyToken: "0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",
        receiver: "0xb00b4c1e371dee4f6f32072641430656d3f7c064",
        sellAmount: "5000000000000000000000",
        buyAmount: "20404249",
        validTo: 1754669895,
        appData:
          "0x5a8bb9f6dd0c7f1b4730d9c5a811c2dfe559e67ce9b5ed6965b05e59b8c86b80",
        feeAmount: "0",
        kind: "sell",
        partiallyFillable: false,
        sellTokenBalance: "erc20",
        buyTokenBalance: "erc20",
        signingScheme: "eip712",
        signature:
          "0x67d99c8d0f675223f1cfe607bae0405e1eb34805cd1294556e69ae2f56ed34a465c2b15a6f3df45e696eb2e4700bdb9e2dea08aa5a78195be016905609006adc1c",
        interactions: {
          pre: [],
          post: [],
        },
        totalFee: "0",
      },
      {
        creationDate: "2025-08-07T14:34:02.897883Z",
        owner: "0xb00b4c1e371dee4f6f32072641430656d3f7c064",
        uid: "0x1b41f275175a440be19b404de7e9a721533f4e3f88c352a74f97ea063948028eb00b4c1e371dee4f6f32072641430656d3f7c0646894c057",
        availableBalance: null,
        executedBuyAmount: "0",
        executedSellAmount: "0",
        executedSellAmountBeforeFees: "0",
        executedFeeAmount: "0",
        executedFee: "0",
        executedFeeToken: "0xe485e2f1bab389c08721b291f6b59780fec83fd7",
        invalidated: true,
        status: "cancelled",
        class: "limit",
        settlementContract: "0x9008d19f58aabd9ed0d60971565aa8510560ab41",
        isLiquidityOrder: false,
        fullAppData:
          '{"appCode":"CoW Swap","environment":"production","metadata":{"orderClass":{"orderClass":"market"},"quote":{"slippageBips":1,"smartSlippage":false},"utm":{"utmContent":"menubar-nav-button-trade-on-cow-swap","utmMedium":"web","utmSource":"cow.fi"}},"version":"1.5.0"}',
        sellToken: "0xe485e2f1bab389c08721b291f6b59780fec83fd7",
        buyToken: "0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",
        receiver: "0xb00b4c1e371dee4f6f32072641430656d3f7c064",
        sellAmount: "4000000000000000000000",
        buyAmount: "16361001",
        validTo: 1754579031,
        appData:
          "0x753b3430bef8e6f4d8596d929ec63427802e5bbf99f8a1bbf872ffac876125fc",
        feeAmount: "0",
        kind: "sell",
        partiallyFillable: false,
        sellTokenBalance: "erc20",
        buyTokenBalance: "erc20",
        signingScheme: "eip712",
        signature:
          "0x7f837adfe5398394ff9fc27bd3bc321decc97493d1c2af78c9bd3bc2ecc759df65cadd1c478e3c5dbe071511841764cc35f8fb164327f6ad0fc3ded325d733011c",
        interactions: {
          pre: [],
          post: [],
        },
        totalFee: "0",
      },
      {
        creationDate: "2025-07-26T13:56:16.984610Z",
        owner: "0xb00b4c1e371dee4f6f32072641430656d3f7c064",
        uid: "0xf944f0de097e6c3724ebbd4e18881df348ca6e8fc388b322e76b5aa139a819fcb00b4c1e371dee4f6f32072641430656d3f7c0646884e57b",
        availableBalance: null,
        executedBuyAmount: "95155864",
        executedSellAmount: "25464867331308488",
        executedSellAmountBeforeFees: "25464867331308488",
        executedFeeAmount: "0",
        executedFee: "47061046759568",
        executedFeeToken: "0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2",
        invalidated: false,
        status: "fulfilled",
        class: "limit",
        settlementContract: "0x9008d19f58aabd9ed0d60971565aa8510560ab41",
        isLiquidityOrder: false,
        fullAppData:
          '{"appCode":"CoW Swap","environment":"production","metadata":{"orderClass":{"orderClass":"market"},"quote":{"slippageBips":10,"smartSlippage":false},"utm":{"utmContent":"menubar-nav-button-trade-on-cow-swap","utmMedium":"web","utmSource":"cow.fi"}},"version":"1.4.0"}',
        sellToken: "0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2",
        buyToken: "0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",
        receiver: "0xb00b4c1e371dee4f6f32072641430656d3f7c064",
        sellAmount: "25464867331308488",
        buyAmount: "95075165",
        validTo: 1753539963,
        appData:
          "0xcd31169a713a0f3aa6eb9e4f47b7294aa12668db346f54d34199b112b0f86509",
        feeAmount: "0",
        kind: "sell",
        partiallyFillable: false,
        sellTokenBalance: "erc20",
        buyTokenBalance: "erc20",
        signingScheme: "eip712",
        signature:
          "0x6e9fd6592280e03626a55b83087e1c8440942b1a055fa80686c412904ebeb4393871c675ccd7232253aa098cf92f78487d170f094b3b37dde588caa6b562c05a1c",
        interactions: {
          pre: [],
          post: [],
        },
        totalFee: "47061046759568",
      },
    ]);
  });
});
